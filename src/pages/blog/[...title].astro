---
import { getCollection } from "astro:content";
import BlogLayout from "../../layouts/blogLayout.astro";
import { GET } from "../api/data.json";

export const prerender = false;

const { title: queryBlog } = Astro.params;
const blogCollection = await getCollection("blog");
const posts = blogCollection.filter((post) => {
    return post.slug === queryBlog;
});
const hasPage = posts && posts.length && posts.length > 0;
if (!hasPage) {
    return Astro.redirect("/404");
}
const post = posts[0];
const pageContent = post.data;
const Content = (await post.render()).Content;
const response = await GET();
const dataJson = await response.json();
console.log('[...title] props', Astro.props, ',params:', Astro.params);
---
<!-- make sure pageContent exist -->
<BlogLayout
    title={pageContent.title}
    description={pageContent.description + '---from:' + dataJson.message}
    author={pageContent.author}
    pubDate={pageContent.pubDate}
    heroImage={pageContent.heroImage}
    tags={pageContent.tags}
>
    <Content />
</BlogLayout>
